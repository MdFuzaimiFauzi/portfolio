---
tags:
  - postmethod
  - postman
  - postgreSQL
  - powershell
  - command
  - cmd
  - post
  - CRUD
---
## **ðŸ“Œ POST Method**

ðŸ’¡ **Why?**

- Because we need to **store the new data** into our database.
- We use **HTTP POST** to send the new data to the API.

---
### **ðŸ”¦Step 1: Update** **`TaskController.cs`** 

Add **new method** for `POST` in the `controller` in the Controller folder


```
// CREATE NEW TASK

[HttpPost]
public IActionResult CreateTask([FromBody] TaskItem newTask)
{
    if (newTask == null)
    {
        return BadRequest("Task data is required");
    }

    _context.Tasks.Add(newTask);
    _context.SaveChanges();

    return CreatedAtAction(nameof(GetTasks), new { id = newTask.Id }, newTask);
}

```

---
### ðŸ”¦**Step 2: Update Database**

> [!note]
> Run with Terminal, same directory as the working branch
>

1ï¸âƒ£ Add columns `Status` into **TaskItem**.
```
dotnet ef migrations add AddStatusColumnToTaskItem
```

2ï¸âƒ£ Update the database with the added column.
```
dotnet ef database update
```

---
### ðŸ”¦**Step 3: Check Database**


> [!note]
> Run **Terminal** as administrator

1ï¸âƒ£ **Initiate** the Postgres.
```
psql -U postgres
```

2ï¸âƒ£ **List out** all available databases.
```
-l
```

3ï¸âƒ£ **Make sure** our working database `TaskManagerDB` is in the list.

4ï¸âƒ£ **Connect** to our database `TaskManagerDB`.
```
\c TaskManagerDB
```

5ï¸âƒ£ **Check** for the column Status in `TaskManagerDB` database.
```
SELECT column_name
FROM information_schema.columns
WHERE table_name = 'Tasks';
```

6ï¸âƒ£ The **Status** column is successfully added into `TaskManagerDB` database.

![[check_status_column_db.png]]

---
### ðŸ”¦**Step 4: Create POST body in Insomnia**

1ï¸âƒ£ **Open up Insomnia**.

2ï¸âƒ£ **Choose** `POST` method.

3ï¸âƒ£ **Insert the URL** :
```
http://localhost:5022/api/tasks
```

4ï¸âƒ£ **Go to the tab** `Body`, and choose `JSON`, insert this :
```
{
    "title": "New Task",
    "description": "Learn CRUD API",
    "status": "Pending"
}
```

> [!info]
> This `JSON` body is important, as if we want to post another data for the `title`, `description` and the `status`.

---

### ðŸ”¦**Step 5: Test with Insomnia**

5ï¸âƒ£ **Click** `Send`

âœ… **Expected Response (201 Created)**
```
{
   "id": 3,
   "title": "New Task",
   "description": "Learn CRUD API",
   "status": "Pending"
}
```

6ï¸âƒ£ The `POST` method is **succeeded**.

![[post_created.png]]

> [!success]
> âœ… Database connected and migration applied
> âœ… POST Method implemented
> âœ… Tested with Insomnia
